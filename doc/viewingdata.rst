Viewing Data 
===============================

Loading experimental data
-------------------------

Data format
^^^^^^^^^^^

HNN currently supports loading dipole data stored in plain text files. 
The first column of a txt file is the time, and the second column is
the dipole time-series. HNN assumes data is sampled at 600 Hz, the
standard for many MEG systems. We have provided a few examples of MEG ERP
data to get you started. This data is located in the data subfolder under
the hnn root folder.

How to Load Data
^^^^^^^^^^^^^^^^

From the main HNN window, go to ``File menu`` -> ``Load data file``
and select the file. HNN will then load the data and display the waveform
in the dipole panel of the output canvas as shown below.

.. figure:: images/ERPYes2Compare.png
	:scale: 40%	
	:align: center

In this example, the dotted yellow line is the experimental data and the solid
lines are from the simulation (gray lines are individual trials, black line
is average across trials).

Root-mean-square error (RMSE) comparison of model and experimental data
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

When HNN loads dipole data, it performs a root-mean-square error
comparison against all simulation dipole traces. 
Root mean squared error is defined as :math:`\sqrt \frac{\sum (S_i - E_i)^2}{n}`.
The summation is across all corresponding samples of the simulated (:math:`S`)
and experimental (:math:`E`) dipole signals, where there are :math:`n` samples.
Since the simulation typically uses a higher sampling rate than MEG data,
HNN downsamples the simulation data before performing the RMSE calculation.

Viewing experimental spectrograms
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Viewing experimental power spectral density
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

HNN can compare simulation and experimental data PSDs. 

For this example, we will use a param file from a simulation
that produces alpha and beta events. Download the relevant param file
here: - `AlphaAndBeta.param <../../param/AlphaAndBeta.param>`_
Then load the parameter file values by clicking ``Set Parameters From File``
and selecting the file you just downloaded. If you have not already run
this simulation, do so now with ``Start Simulation``. 
Then, to view the simulation's power spectral density (PSD) -- the time
average of the spectrogram, click on the ``View menu`` -> ``View PSD``. You should see
the following window.

.. figure:: images/AlphaAndBetaViewPSD.png
	:scale: 40%	
	:align: center

	Power spectral density from the simulation shows a strong peak at alpha (10 Hz), with
	a lower power in beta (~20 Hz). Top/middle/bottom panels show the PSD contributions
	from layer 2, layer 5, and the aggregate from layer 2 and layer 5.

We can then use HNN to compare to experimental PSD data. To do so, you will need time-series
of MEG data in a format that HNN can read (more details provided above). Once
you have such data, you can load it with the HNN PSD viewer by clicking
``File menu`` -> ``Load data``, and then picking the file. Then HNN will calculate the PSD
from the time-series data and overlay it on the simulation PSD for comparison.
Below is an example.

.. figure:: images/AlphaAndBetaViewPSDCompare.png
	:scale: 40%	
	:align: center

	Strong similarity of PSD generated by model (bottom white traces) and PSD from experimental
	MEG data (bottom yellow traces). Solid/dotted lines are mean+/-standard error. This data is
	from primary somatosensory cortex from spontaneous prestimulus activity.

